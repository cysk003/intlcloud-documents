본 문서는 콘솔을 통해 MySQL 인스턴스의 binlog 보관 주기를 설정하는 방법에 대해 소개합니다.
>?
>- 단일 노드 클라우드 디스크 인스턴스는 로컬 binlog 보관 설정을 지원하지 않습니다.
>- 원본 인스턴스에 재해 복구 인스턴스가 있는 경우 로컬 binlog 보관 시간은 120시간보다 짧을 수 없습니다. 

## binlog 설명
TencentDB for MySQL 인스턴스는 대량의 트랜잭션 또는 대량의 DML 실행 시 비교적 많은 binlog를 생성합니다. 입력량이 256MB에 도달한 binlog는 분할되고, 분할된 binlog 파일은 COS에 업로드됩니다. 콘솔의 로그 리스트에 업로드된 binlog 파일이 표시됩니다.
![](https://main.qcloudimg.com/raw/bcf3d0d2ac291ccebbcfebea05fd11f1.png)

## 작업 시나리오
binlog는 COS에 업로드되기 전 인스턴스 디스크에 임시 저장되며, 이로 인해 디스크 사용 용량이 증가하게 됩니다. 콘솔에서 Binlog 보관 주기를 설정하여 점유 용량 비율을 조정하거나 디스크를 확장할 수 있습니다. 사용률을 80% 이하로 유지하는 것을 권장하며, 사용하지 않는 데이터는 정리하시기 바랍니다.
- binlog는 MySQL 데이터 동기화의 기본입니다. TencentDB for MySQL은 데이터베이스의 복원성, 안정성, 고가용성 유지를 위해 binlog 비활성화를 지원하지 않습니다.
- 생성된 binlog는 시스템의 [자동 백업 기능](https://intl.cloud.tencent.com/document/product/236/37796)을 통해 COS에 백업됩니다. 백업 후의 binlog는 설정된 로컬 binlog 보관 정책에 따라 삭제되며, 사용 중인 binlog는 오류 방지를 위해 삭제할 수 없습니다. 이에 따라 정리 과정에서 일정 시간의 딜레이가 발생합니다. 설정 후 조금만 기다려 주십시오.
>?만료된 binlog 로그 삭제 규칙
>60초마다 한 번씩 로컬 binlog 로그를 점검하여 biglog의 시작 시간 혹은 점유한 공간이 설정한 보관 규칙에 부합하지 않을 경우 해당 binlog는 삭제 큐에 추가됩니다. 삭제 큐 중의 binlog는 시간 순서에 따라 가장 오래된 것부터 삭제 대기 큐가 비워질 때까지 하나씩 삭제됩니다.

## 작업 단계
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 후, 인스턴스 리스트 페이지에서 인스턴스 ID를 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지에서 **백업 및 복구** 탭을 선택하고, **로컬 Binlog 구성**을 클릭합니다.
3. 팝업 창에서 보관 기간 및 공간 활용 임계값을 지정하고 **확인**을 클릭합니다.
![](https://staticintl.cloudcachetci.com/yehe/backend-news/e5xL948_37.png)

## FAQ
#### 로컬 binlog 보관 시간을 너무 짧게 설정하면 데이터베이스 복구에 영향을 미치나요?
영향을 미치지 않습니다. 생성된 binlog는 자동 백업 기능을 통해 최대한 빠르게 COS에 업로드되며, 업로드되기 전에는 삭제되지 않습니다. 단, 로컬 binlog 보관 시간이 너무 짧으면 롤백 속도에 영향을 미치므로 적합하게 설정하시기 바랍니다.

#### 로컬 binlog 보관 시간은 기본적으로 몇 시간으로 설정되어 있나요?
기본적으로 로컬 binlog 보관 기간은 120시간이고 최대 binlog 공간 사용률은 30%입니다. 필요에 따라 보관 시간을 설정할 수 있습니다. 원본 인스턴스에 재해 복구 인스턴스가 있는 경우 120시간보다 짧을 수 없습니다. 그렇지 않으면 시간 범위는 72~168시간입니다.

#### binlog는 인스턴스 디스크 용량을 점유하나요?
점유합니다. 생성된 binlog는 COS에 자동 백업되며, 백업 후의 binlog는 설정된 보관 정책에 따라 삭제됩니다. 그동안 binlog는 인스턴스 디스크에 임시 저장됩니다.
